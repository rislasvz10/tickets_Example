# serv-ticket-validation

```
This microservice This micro service is used to find and create a ticket.
```

```
ResponseEntity saveTicket(
      @RequestHeader(name = ApiConstants.ACCEPT) @Valid @Pattern(regexp = ApiConstants.REGEX, message = ApiConstants.REGEX_MSG) String accept,
      @RequestHeader(name = ApiConstants.UUID) String uuid,
      @RequestHeader(name = ApiConstants.CLIENT_ID) String clientId,
      @RequestHeader(name = ApiConstants.AUTHORIZATION) String authorization,
      @RequestHeader(name = ApiConstants.ACCEPT_LANGUAGE, required = false) String language,
      @RequestHeader(name = ApiConstants.COUNTRY_CODE, required = false) String countryCode,
      @RequestHeader(name = ApiConstants.BUSINESS_CODE, required = false) String businessCode,
      @RequestHeader(name = ApiConstants.CONTENT_TYPE) String contentType,
      @RequestHeader(name = ApiConstants.CHANNEL_ID) String channelId,
      @RequestHeader(name = ApiConstants.SID) String sid,
      @Validated @RequestBody TicketRequest request)
```

    1. Receives a EvalSenderRequest object and HttpHeaders.
    2. The payload from the request must be encrypted.
	3. Extracts accept, uuid, client_id, Authorization, Content-Type, ChannelId, sid as required and acceptLanguage, countryCode, businessCode, as not required, then send it to the service.
	4. The service decrypts the payload and makes the request, finally encrypts the object and send the encrypted payload.
	5. Returns EvalSenderResponse object.

### Versioning

* **Version** 1.0

* **LOG classes**
    - N/A

* **PMD changes**
    - All

* **Checkstyle**
    - All

* **FindBugs**
    - All

* **Others**
    - LombokÂ´s annotations:
        - TicketRequest.java
        - TicketResponse.java
        - Ticket.java

#### Last modification date:

Raul Gutierrez Molina Oct/23/2021

#### Change history

Raul Gutierrez Molina Oct/23/2021

### Endpoints

> /api/v1/operation/ticket/insert (POST)

#### Request data

``` 
This JSON is to create a ticket.
```

```json
{
  "destino": "Mexico",
  "edad": 33,
  "equipaje": true,
  "fechaLlegada": "24/10/2021",
  "fechaSalida": "24/10/2021",
  "horaLlegada": "10:50",
  "horaSalida": "08:30",
  "nombre": "Raul Gutierrez",
  "origen": "BCS",
  "precio": 10000
}
```

#### Response

```
> Status: 200, OK
```

> http://localhost:8080/api/v1/operation/ticket/id?id=1 (POST)

#### Response

```json
{
  "itineraryID": 1,
  "fechaSalida": "2021-10-24",
  "fechaLlegada": "2021-10-24",
  "origen": "BCS",
  "destino": "Mexico",
  "nombre": "Raul Gutierrez",
  "edad": 33,
  "equipaje": true,
  "precio": 10000,
  "horaSalida": "08:30:00",
  "horaLlegada": "10:50:00"
}
```

## Built With

* Maven
* Spring
* SpringBoot

### Prerequisites

You need to have installed:

- Logged in the enterprise intranet
- Java 1.8
- Maven
- Spring Tool Suite or IntelliJ IDE
- Lombok installed inside IDE

## Deployment

```console
	$ mvn spring boot:run
```

Or from STS right click on the project -> Run As -> Spring Boot App

- On STS(Spring Tool Suite) right click on the project  > Run As >
  JUnit Test
- Or for **debugging** right click on the project  > Debug As > JUnit Test

For run a unique test just go to the src/test/java package that is the test and select the test by
clicking on the name of it -> Right click --> Run As -> JUnit test

For run a unique test in debug mode just go to the src/test/java package that is the test and select
the test by clicking on the name of it -> Right click --> Debug As -> JUnit test

To run this microservice in local mode use the ```bootstrap.yml``` file.

Be sure to not commit this changes to BitBucket.

To generate a google standard check-style html site.

It is divided in two categories:

1. Project Information

    - Provides an overview of the various documents and links that are part of this project's
      general information.

2. Project Reports

    - Provides an overview of the various reports that are automatically generated by Maven.

The site is generated on the project folder: target > site > index.html

	$ mvn clean install site -Pdevelopment_reporting sonar:sonar

Sonar is an open source platform used by development teams to manage source code quality.

	$ mvn clean test sonar:sonar

Or from STS rigth click on the project -> Run As -> Maven Build... -> Goals: sonar:sonar -> Run

In the lasts lines of the console there is a link, copy and paste it on any web browser to see the
report.